!function(e){e.contextMenu={shadow:!0,shadowOffset:0,shadowOffsetX:5,shadowOffsetY:5,shadowWidthAdjust:-3,shadowHeightAdjust:-3,shadowOpacity:.2,shadowClass:"context-menu-shadow",shadowColor:"black",offsetX:0,offsetY:0,appendTo:"body",direction:"down",constrainToScreen:!0,showTransition:"show",hideTransition:"hide",showSpeed:null,hideSpeed:null,showCallback:null,hideCallback:null,className:"context-menu",itemClassName:"context-menu-item",itemHoverClassName:"context-menu-item-hover",disabledItemClassName:"context-menu-item-disabled",disabledItemHoverClassName:"context-menu-item-disabled-hover",separatorClassName:"context-menu-separator",innerDivClassName:"context-menu-item-inner",themePrefix:"context-menu-theme-",theme:"default",separator:"context-menu-separator",target:null,menu:null,shadowObj:null,bgiframe:null,shown:!1,useIframe:!1,create:function(t,a){var s=e.extend({},this,a);return"string"==typeof t?s.menu=e(t):"function"==typeof t?s.menuFunction=t:s.menu=s.createMenu(t,s),s.menu&&(s.menu.css({display:"none"}),e(s.appendTo).append(s.menu)),s.shadow&&(s.createShadow(s),s.shadowOffset&&(s.shadowOffsetX=s.shadowOffsetY=s.shadowOffset)),e("body").bind("contextmenu",function(){s.hide()}),s},createIframe:function(){return e('<iframe frameborder="0" tabindex="-1" src="javascript:false" style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=0);"/>')},createMenu:function(t,a){var s=a.className;e.each(a.theme.split(","),function(e,t){s+=" "+a.themePrefix+t});for(var n=e("<table cellspacing=0 cellpadding=0></table>").click(function(){return a.hide(),!1}),o=e("<tr></tr>"),i=e("<td></td>"),d=e('<div class="'+s+'"></div>'),r=0;r<t.length;r++){var h=t[r];if(h==e.contextMenu.separator)d.append(a.createSeparator());else for(var l in t[r])d.append(a.createMenuItem(l,t[r][l]))}return a.useIframe&&i.append(a.createIframe()),n.append(o.append(i.append(d))),n},createMenuItem:function(t,a){var s=this;"function"==typeof a&&(a={onclick:a});var n=e.extend({onclick:function(){},className:"",hoverClassName:s.itemHoverClassName,icon:"",disabled:!1,title:"",hoverItem:s.hoverItem,hoverItemOut:s.hoverItemOut},a),o=n.icon?"background-image:url("+n.icon+");":"",i=e('<div class="'+s.itemClassName+" "+n.className+(n.disabled?" "+s.disabledItemClassName:"")+'" title="'+n.title+'"></div>').click(function(e){return s.isItemDisabled(this)?!1:n.onclick.call(s.target,this,s,e)}).hover(function(){n.hoverItem.call(this,s.isItemDisabled(this)?s.disabledItemHoverClassName:n.hoverClassName)},function(){n.hoverItemOut.call(this,s.isItemDisabled(this)?s.disabledItemHoverClassName:n.hoverClassName)}),d=e('<div class="'+s.innerDivClassName+'" style="'+o+'">'+t+"</div>");return i.append(d),i},createSeparator:function(){return e('<div class="'+this.separatorClassName+'"></div>')},isItemDisabled:function(t){return e(t).is("."+this.disabledItemClassName)},hoverItem:function(t){e(this).addClass(t)},hoverItemOut:function(t){e(this).removeClass(t)},createShadow:function(t){t.shadowObj=e('<div class="'+t.shadowClass+'"></div>').css({display:"none",position:"absolute",zIndex:9998,opacity:t.shadowOpacity,backgroundColor:t.shadowColor}),e(t.appendTo).append(t.shadowObj)},showShadow:function(e,t,a){var s=this;s.shadow&&s.shadowObj.css({width:s.menu.width()+s.shadowWidthAdjust+"px",height:s.menu.height()+s.shadowHeightAdjust+"px",top:t+s.shadowOffsetY+"px",left:e+s.shadowOffsetX+"px"}).addClass(s.shadowClass)[s.showTransition](s.showSpeed)},beforeShow:function(){return!0},show:function(t,a){var s=this,n=a.pageX,o=a.pageY;if(s.target=t,s.beforeShow()!==!1){s.menuFunction&&(s.menu&&e(s.menu).remove(),s.menu=s.createMenu(s.menuFunction(s,t),s),s.menu.css({display:"none"}),e(s.appendTo).append(s.menu));var i=s.menu;n+=s.offsetX,o+=s.offsetY;var d=s.getPosition(n,o,s,a);s.showShadow(d.x,d.y,a),s.useIframe&&i.find("iframe").css({width:i.width()+s.shadowOffsetX+s.shadowWidthAdjust,height:i.height()+s.shadowOffsetY+s.shadowHeightAdjust}),i.css({top:d.y+"px",left:d.x+"px",position:"absolute",zIndex:9999})[s.showTransition](s.showSpeed,s.showCallback?function(){s.showCallback.call(s)}:null),s.shown=!0}},getPosition:function(t,a,s,n){var o=t+s.offsetX,i=a+s.offsetY,d=e(s.menu).height(),r=e(s.menu).width(),h=s.direction;if(s.constrainToScreen){var l=e(window),c=l.height(),u=l.width();"down"==h&&i+d-l.scrollTop()>c&&(h="up");var m=o+r-l.scrollLeft();m>u&&(o-=m-u)}return"up"==h&&(i-=d),{x:o,y:i}},hide:function(){var t=this;t.shown&&(t.iframe&&e(t.iframe).hide(),t.menu&&t.menu[t.hideTransition](t.hideSpeed,t.hideCallback?function(){t.hideCallback.call(t)}:null),t.shadow&&t.shadowObj[t.hideTransition](t.hideSpeed)),t.shown=!1}},e.fn.contextMenu=function(t,a){var s=e.contextMenu.create(t,a);return this.each(function(){e(this).bind("contextmenu",function(e){return s.show(this,e),!1})})}}(jQuery);